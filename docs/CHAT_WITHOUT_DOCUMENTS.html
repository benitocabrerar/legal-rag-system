<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Sin Documentos - Legal RAG System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }

        h2 {
            color: #34495e;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-left: 10px;
            border-left: 4px solid #3498db;
        }

        h3 {
            color: #555;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .section {
            margin-bottom: 40px;
        }

        .problem-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .solution-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .info-box {
            background: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .code-block {
            background: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }

        .code-block .keyword { color: #c678dd; }
        .code-block .function { color: #61afef; }
        .code-block .string { color: #98c379; }
        .code-block .number { color: #d19a66; }
        .code-block .comment { color: #5c6370; font-style: italic; }
        .code-block .operator { color: #56b6c2; }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .before, .after {
            padding: 20px;
            border-radius: 8px;
        }

        .before {
            background: #fee;
            border: 2px solid #e74c3c;
        }

        .after {
            background: #efe;
            border: 2px solid #2ecc71;
        }

        .before h4, .after h4 {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .flowchart {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 30px;
            margin: 20px 0;
        }

        .flow-step {
            background: white;
            border: 2px solid #3498db;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            position: relative;
        }

        .flow-step::after {
            content: '‚Üì';
            display: block;
            text-align: center;
            font-size: 24px;
            color: #3498db;
            margin: 10px 0 -10px 0;
        }

        .flow-step:last-child::after {
            content: '';
        }

        .flow-step-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .flow-step-desc {
            color: #666;
            font-size: 14px;
        }

        .dual-mode {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }

        .mode-card {
            padding: 20px;
            border-radius: 8px;
            border: 2px solid;
        }

        .mode-rag {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #5a67d8;
        }

        .mode-general {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-color: #e53e3e;
        }

        .mode-card h4 {
            margin-bottom: 15px;
            font-size: 18px;
        }

        .mode-card ul {
            list-style: none;
            padding: 0;
        }

        .mode-card li {
            padding: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .mode-card li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th {
            background: #3498db;
            color: white;
            padding: 12px;
            text-align: left;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin: 0 5px;
        }

        .badge-success { background: #d4edda; color: #155724; }
        .badge-warning { background: #fff3cd; color: #856404; }
        .badge-danger { background: #f8d7da; color: #721c24; }
        .badge-info { background: #d1ecf1; color: #0c5460; }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }

        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }

        .screenshot {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            background: #f8f9fa;
            margin: 20px 0;
        }

        .screenshot img {
            max-width: 100%;
            border-radius: 4px;
        }

        .commit-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            font-family: monospace;
        }

        .commit-info .hash {
            color: #e74c3c;
            font-weight: bold;
        }

        .commit-info .message {
            color: #2c3e50;
            margin: 10px 0;
        }

        .commit-info .files {
            color: #27ae60;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîì Habilitaci√≥n de Chat Sin Documentos - Legal RAG System</h1>

        <div class="info-box">
            <strong>üìã Documento T√©cnico de Implementaci√≥n</strong><br>
            Este documento explica los cambios implementados para permitir que los usuarios utilicen el asistente de chat IA sin necesidad de subir documentos previamente, implementando un sistema dual inteligente.
        </div>

        <section id="problem" class="section">
            <h2>‚ùå Problema Identificado</h2>

            <div class="problem-box">
                <h3>üö´ Restricci√≥n Innecesaria</h3>
                <p>El sistema requer√≠a que los usuarios subieran documentos antes de poder usar el chat, lo que creaba una barrera de entrada y limitaba la utilidad del asistente legal IA.</p>
            </div>

            <h3>S√≠ntomas del Problema:</h3>
            <ul>
                <li>‚úó El campo de texto del chat aparec√≠a <strong>deshabilitado</strong> sin documentos</li>
                <li>‚úó Mensaje: <em>"Sube documentos para empezar a consultar..."</em></li>
                <li>‚úó Bot√≥n "Enviar" deshabilitado cuando <code>documents.length === 0</code></li>
                <li>‚úó Los usuarios no pod√≠an hacer preguntas legales generales</li>
                <li>‚úó Mala experiencia de usuario al entrar a un caso nuevo</li>
            </ul>

            <h3>C√≥digo Frontend Original (Problem√°tico):</h3>
            <div class="code-block">
<span class="comment">// Textarea deshabilitado sin documentos</span>
&lt;textarea
  <span class="keyword">disabled</span>={querying <span class="operator">||</span> documents.length <span class="operator">===</span> <span class="number">0</span>}
  <span class="keyword">placeholder</span>={
    documents.length <span class="operator">===</span> <span class="number">0</span>
      ? <span class="string">'Sube documentos para empezar a consultar...'</span>
      : <span class="string">'Escribe tu consulta legal...'</span>
  }
/&gt;

<span class="comment">// Bot√≥n deshabilitado sin documentos</span>
&lt;button
  <span class="keyword">disabled</span>={querying <span class="operator">||</span> !query.trim() <span class="operator">||</span> documents.length <span class="operator">===</span> <span class="number">0</span>}
&gt;
  Enviar
&lt;/button&gt;
            </div>

            <h3>Impacto en la Experiencia del Usuario:</h3>
            <table>
                <thead>
                    <tr>
                        <th>Escenario</th>
                        <th>Comportamiento Anterior</th>
                        <th>Problema</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Usuario crea nuevo caso</td>
                        <td>Chat bloqueado, debe subir documentos</td>
                        <td>No puede hacer preguntas generales</td>
                    </tr>
                    <tr>
                        <td>Pregunta legal general</td>
                        <td>Imposible sin documentos</td>
                        <td>Limita utilidad del asistente IA</td>
                    </tr>
                    <tr>
                        <td>Consulta r√°pida</td>
                        <td>Requiere upload innecesario</td>
                        <td>Fricci√≥n en el flujo de trabajo</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="solution" class="section">
            <h2>‚úÖ Soluci√≥n Implementada</h2>

            <div class="solution-box">
                <h3>üéØ Sistema Dual Inteligente</h3>
                <p>Se implement√≥ un sistema que detecta autom√°ticamente si hay documentos disponibles y adapta el comportamiento del asistente:</p>
                <ul>
                    <li><strong>CON documentos:</strong> Modo RAG (Retrieval Augmented Generation) con an√°lisis espec√≠fico</li>
                    <li><strong>SIN documentos:</strong> Modo Asistente Legal General con informaci√≥n de derecho</li>
                </ul>
            </div>

            <div class="dual-mode">
                <div class="mode-card mode-rag">
                    <h4>üìö Modo RAG (Con Documentos)</h4>
                    <ul>
                        <li>Vectorizaci√≥n de documentos</li>
                        <li>B√∫squeda por similitud</li>
                        <li>Respuestas basadas en contexto</li>
                        <li>Citaci√≥n de fuentes espec√≠ficas</li>
                        <li>An√°lisis detallado del caso</li>
                    </ul>
                </div>
                <div class="mode-card mode-general">
                    <h4>ü§ñ Modo General (Sin Documentos)</h4>
                    <ul>
                        <li>Asistente legal general</li>
                        <li>Respuestas de informaci√≥n legal</li>
                        <li>Principios y gu√≠as legales</li>
                        <li>Sugerencia de subir documentos</li>
                        <li>Disclaimer de asesor√≠a general</li>
                    </ul>
                </div>
            </div>

            <h3>Cambios en el Frontend:</h3>

            <div class="comparison">
                <div class="before">
                    <h4>‚ùå ANTES</h4>
                    <div class="code-block" style="font-size: 12px;">
<span class="comment">// Deshabilitado</span>
disabled={
  querying <span class="operator">||</span>
  documents.length <span class="operator">===</span> <span class="number">0</span>
}

<span class="comment">// Placeholder condicional</span>
placeholder={
  documents.length <span class="operator">===</span> <span class="number">0</span>
    ? <span class="string">'Sube documentos...'</span>
    : <span class="string">'Escribe tu consulta...'</span>
}
                    </div>
                </div>

                <div class="after">
                    <h4>‚úÖ DESPU√âS</h4>
                    <div class="code-block" style="font-size: 12px;">
<span class="comment">// Solo deshabilitar si est√° procesando</span>
disabled={querying}

<span class="comment">// Placeholder siempre positivo</span>
placeholder={
  <span class="string">'Escribe tu consulta legal...'</span>
}
                    </div>
                </div>
            </div>

            <h3>Archivo: frontend/src/app/dashboard/cases/[id]/page.tsx</h3>

            <h4>1. Eliminaci√≥n de Restricci√≥n en Textarea:</h4>
            <div class="code-block">
<span class="comment">// ANTES: disabled={querying || documents.length === 0}</span>
<span class="comment">// DESPU√âS:</span>

&lt;textarea
  value={query}
  <span class="function">onChange</span>={(e) <span class="operator">=&gt;</span> <span class="function">setQuery</span>(e.target.value)}
  <span class="keyword">disabled</span>={querying}  <span class="comment">// ‚Üê Solo deshabilitar durante query</span>
  <span class="keyword">placeholder</span>=<span class="string">"Escribe tu consulta legal..."</span>
  rows={<span class="number">3</span>}
  className=<span class="string">"w-full px-4 py-3 border border-gray-300..."</span>
/&gt;
            </div>

            <h4>2. Eliminaci√≥n de Restricci√≥n en Bot√≥n Enviar:</h4>
            <div class="code-block">
<span class="comment">// ANTES: disabled={querying || !query.trim() || documents.length === 0}</span>
<span class="comment">// DESPU√âS:</span>

&lt;button
  <span class="keyword">type</span>=<span class="string">"submit"</span>
  <span class="keyword">disabled</span>={querying <span class="operator">||</span> !query.<span class="function">trim</span>()}  <span class="comment">// ‚Üê Sin verificaci√≥n de documentos</span>
  className=<span class="string">"px-6 py-3 bg-gradient-to-r from-indigo-600..."</span>
&gt;
  &lt;Send className=<span class="string">"w-5 h-5"</span> /&gt;
  Enviar
&lt;/button&gt;
            </div>

            <h4>3. Actualizaci√≥n de Mensajes de Bienvenida:</h4>
            <div class="code-block">
<span class="comment">// Header del chat</span>
&lt;p className=<span class="string">"text-sm text-gray-600 mt-1"</span>&gt;
  {documents.length <span class="operator">&gt;</span> <span class="number">0</span>
    ? `Analizando ${documents.length} documento${documents.length <span class="operator">&gt;</span> <span class="number">1</span> ? <span class="string">'s'</span> : <span class="string">''</span>}`
    : <span class="string">'Listo para responder tus consultas legales'</span>}  <span class="comment">// ‚Üê Mensaje positivo</span>
&lt;/p&gt;

<span class="comment">// Mensaje de bienvenida inicial</span>
&lt;p className=<span class="string">"text-gray-600 mb-6 max-w-md mx-auto"</span>&gt;
  Preg√∫ntame lo que necesites. Puedo ayudarte con an√°lisis de documentos,
  referencias legales, redacci√≥n y estrategia legal.
  Sube documentos para an√°lisis espec√≠ficos.  <span class="comment">// ‚Üê Sugiere, no requiere</span>
&lt;/p&gt;
            </div>
        </section>

        <section id="backend" class="section">
            <h2>‚öôÔ∏è Cambios en el Backend</h2>

            <h3>Archivo: src/routes/query.ts</h3>

            <div class="info-box">
                <strong>üîÑ Sistema Dual de Prompts</strong><br>
                El backend ahora detecta si hay documentos disponibles y ajusta el comportamiento de GPT-4 autom√°ticamente.
            </div>

            <h4>Implementaci√≥n del Sistema Dual:</h4>

            <div class="code-block">
<span class="comment">// Detectar si hay documentos disponibles</span>
<span class="keyword">const</span> hasDocuments = allChunks.length <span class="operator">&gt;</span> <span class="number">0</span>;

<span class="comment">// System Prompt adaptativo</span>
<span class="keyword">const</span> systemPrompt = hasDocuments
  ? <span class="comment">// MODO RAG: Con documentos</span>
    `You are a legal assistant helping with case analysis.
You have access to relevant documents from the case files.
Use the provided context to answer the user's question accurately.
If the context doesn't contain enough information to answer the question, say so clearly.
Always cite which documents you're referencing in your answer.`

  : <span class="comment">// MODO GENERAL: Sin documentos</span>
    `You are a legal assistant helping with general legal questions.
Answer the user's legal questions to the best of your ability.
Provide general legal information, principles, and guidance.
Note: Remind the user they can upload case documents for more specific analysis.
Always clarify that your answers are general legal information and not specific legal advice.`;

<span class="comment">// User Prompt adaptativo</span>
<span class="keyword">const</span> userPrompt = hasDocuments
  ? `Context from case documents:\n\n${context}\n\n---\n\nQuestion: ${body.query}\n\nPlease provide a detailed answer based on the context above.`
  : `Question: ${body.query}\n\nPlease provide a helpful answer with general legal information and guidance.`;
            </div>

            <h3>Flujo de Decisi√≥n del Backend:</h3>

            <div class="flowchart">
                <div class="flow-step">
                    <div class="flow-step-title">1Ô∏è‚É£ Recibir Query del Usuario</div>
                    <div class="flow-step-desc">POST /query con caseId y pregunta</div>
                </div>

                <div class="flow-step">
                    <div class="flow-step-title">2Ô∏è‚É£ Validar Acceso al Caso</div>
                    <div class="flow-step-desc">Verificar que userId sea due√±o del caso</div>
                </div>

                <div class="flow-step">
                    <div class="flow-step-title">3Ô∏è‚É£ Generar Embedding de la Pregunta</div>
                    <div class="flow-step-desc">OpenAI text-embedding-ada-002</div>
                </div>

                <div class="flow-step">
                    <div class="flow-step-title">4Ô∏è‚É£ Buscar Documentos del Caso</div>
                    <div class="flow-step-desc">SELECT * FROM document_chunks WHERE caseId = ?</div>
                </div>

                <div class="flow-step">
                    <div class="flow-step-title">5Ô∏è‚É£ Detectar Modo de Operaci√≥n</div>
                    <div class="flow-step-desc">
                        <strong>Si allChunks.length > 0:</strong> Modo RAG<br>
                        <strong>Si allChunks.length === 0:</strong> Modo General
                    </div>
                </div>

                <div class="flow-step">
                    <div class="flow-step-title">6Ô∏è‚É£ Construir Prompts Apropiados</div>
                    <div class="flow-step-desc">systemPrompt y userPrompt seg√∫n el modo</div>
                </div>

                <div class="flow-step">
                    <div class="flow-step-title">7Ô∏è‚É£ Llamar a GPT-4</div>
                    <div class="flow-step-desc">Generar respuesta con el contexto apropiado</div>
                </div>

                <div class="flow-step">
                    <div class="flow-step-title">8Ô∏è‚É£ Devolver Respuesta al Usuario</div>
                    <div class="flow-step-desc">JSON con answer, sources (si aplica), metadata</div>
                </div>
            </div>

            <h3>Comparaci√≥n de System Prompts:</h3>

            <table>
                <thead>
                    <tr>
                        <th>Caracter√≠stica</th>
                        <th>Modo RAG (Con Docs)</th>
                        <th>Modo General (Sin Docs)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Fuente de Informaci√≥n</strong></td>
                        <td>Documentos del caso</td>
                        <td>Conocimiento general GPT-4</td>
                    </tr>
                    <tr>
                        <td><strong>Tipo de Respuestas</strong></td>
                        <td>Espec√≠ficas al caso</td>
                        <td>Informaci√≥n legal general</td>
                    </tr>
                    <tr>
                        <td><strong>Citaciones</strong></td>
                        <td>‚úÖ Referencias a documentos</td>
                        <td>‚ùå Sin fuentes espec√≠ficas</td>
                    </tr>
                    <tr>
                        <td><strong>B√∫squeda Vectorial</strong></td>
                        <td>‚úÖ Similitud coseno</td>
                        <td>‚ùå No necesaria</td>
                    </tr>
                    <tr>
                        <td><strong>Contexto</strong></td>
                        <td>Top N chunks similares</td>
                        <td>Solo la pregunta</td>
                    </tr>
                    <tr>
                        <td><strong>Disclaimer</strong></td>
                        <td>An√°lisis espec√≠fico</td>
                        <td>‚ö†Ô∏è Informaci√≥n general, no asesor√≠a</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="benefits" class="section">
            <h2>üéÅ Beneficios de la Implementaci√≥n</h2>

            <div class="solution-box">
                <h3>Mejoras en la Experiencia del Usuario:</h3>
                <ol>
                    <li><strong>üöÄ Acceso Inmediato:</strong> Los usuarios pueden empezar a usar el chat sin barreras</li>
                    <li><strong>üí° Mayor Utilidad:</strong> El asistente responde preguntas generales de derecho</li>
                    <li><strong>üîÑ Transici√≥n Suave:</strong> El sistema cambia autom√°ticamente a modo RAG al subir documentos</li>
                    <li><strong>üìö Mejor Onboarding:</strong> Nueva experiencia m√°s acogedora para usuarios nuevos</li>
                    <li><strong>‚ö° Flujo Natural:</strong> Permite consultas r√°pidas sin preparaci√≥n</li>
                </ol>
            </div>

            <h3>Casos de Uso Habilitados:</h3>

            <table>
                <thead>
                    <tr>
                        <th>Escenario</th>
                        <th>Antes</th>
                        <th>Ahora</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>"¬øQu√© es un amparo?"</td>
                        <td><span class="badge badge-danger">Bloqueado</span></td>
                        <td><span class="badge badge-success">Respuesta General</span></td>
                    </tr>
                    <tr>
                        <td>"¬øC√≥mo redactar una demanda?"</td>
                        <td><span class="badge badge-danger">Requiere documentos</span></td>
                        <td><span class="badge badge-success">Gu√≠a General</span></td>
                    </tr>
                    <tr>
                        <td>"Analiza este contrato"</td>
                        <td><span class="badge badge-warning">Debe subir primero</span></td>
                        <td><span class="badge badge-info">Sugiere subir documento</span></td>
                    </tr>
                    <tr>
                        <td>Usuario sube documento</td>
                        <td><span class="badge badge-success">Modo RAG</span></td>
                        <td><span class="badge badge-success">Modo RAG autom√°tico</span></td>
                    </tr>
                </tbody>
            </table>

            <h3>Ventajas T√©cnicas:</h3>
            <ul>
                <li>‚úÖ <strong>C√≥digo m√°s limpio:</strong> Menos condicionales en el frontend</li>
                <li>‚úÖ <strong>Backend inteligente:</strong> Detecci√≥n autom√°tica de contexto</li>
                <li>‚úÖ <strong>Mejor mantenibilidad:</strong> L√≥gica centralizada en el backend</li>
                <li>‚úÖ <strong>Escalabilidad:</strong> F√°cil agregar m√°s modos (ej: modo h√≠brido)</li>
                <li>‚úÖ <strong>Experiencia consistente:</strong> Siempre hay una respuesta √∫til</li>
            </ul>
        </section>

        <section id="testing" class="section">
            <h2>üß™ Escenarios de Prueba</h2>

            <h3>1. Usuario Sin Documentos</h3>
            <div class="code-block">
<span class="comment">// Request</span>
POST /api/v1/query
{
  <span class="string">"caseId"</span>: <span class="string">"caso-sin-documentos-uuid"</span>,
  <span class="string">"query"</span>: <span class="string">"¬øQu√© es la prescripci√≥n en derecho civil?"</span>
}

<span class="comment">// Response</span>
{
  <span class="string">"answer"</span>: <span class="string">"La prescripci√≥n es una figura jur√≠dica que..."</span>,
  <span class="string">"sources"</span>: [],  <span class="comment">// Vac√≠o porque no hay documentos</span>
  <span class="string">"query"</span>: <span class="string">"¬øQu√© es la prescripci√≥n en derecho civil?"</span>,
  <span class="string">"caseId"</span>: <span class="string">"caso-sin-documentos-uuid"</span>
}
            </div>

            <h3>2. Usuario Con Documentos</h3>
            <div class="code-block">
<span class="comment">// Request</span>
POST /api/v1/query
{
  <span class="string">"caseId"</span>: <span class="string">"caso-con-documentos-uuid"</span>,
  <span class="string">"query"</span>: <span class="string">"¬øCu√°l es el plazo del contrato?"</span>
}

<span class="comment">// Response</span>
{
  <span class="string">"answer"</span>: <span class="string">"Seg√∫n el Contrato de Arrendamiento (Chunk 1), el plazo es de 12 meses..."</span>,
  <span class="string">"sources"</span>: [
    {
      <span class="string">"documentId"</span>: <span class="string">"doc-uuid"</span>,
      <span class="string">"documentTitle"</span>: <span class="string">"Contrato de Arrendamiento"</span>,
      <span class="string">"chunkIndex"</span>: <span class="number">0</span>,
      <span class="string">"similarity"</span>: <span class="number">0.89</span>,
      <span class="string">"content"</span>: <span class="string">"El presente contrato se celebra por un plazo de 12 meses..."</span>
    }
  ],
  <span class="string">"query"</span>: <span class="string">"¬øCu√°l es el plazo del contrato?"</span>,
  <span class="string">"caseId"</span>: <span class="string">"caso-con-documentos-uuid"</span>
}
            </div>

            <h3>3. Transici√≥n de Modo General a RAG</h3>
            <div class="info-box">
                <strong>Flujo Completo:</strong>
                <ol>
                    <li>Usuario entra a caso nuevo (sin documentos)</li>
                    <li>Hace pregunta general ‚Üí Recibe respuesta en <strong>Modo General</strong></li>
                    <li>Usuario sube un documento ‚Üí Sistema lo vectoriza</li>
                    <li>Usuario hace nueva pregunta ‚Üí Recibe respuesta en <strong>Modo RAG</strong></li>
                    <li>Transici√≥n autom√°tica y transparente para el usuario</li>
                </ol>
            </div>
        </section>

        <section id="deployment" class="section">
            <h2>üöÄ Informaci√≥n de Despliegue</h2>

            <div class="commit-info">
                <div class="hash">Commit: 2f7e692</div>
                <div class="message">
                    feat: Allow chat queries without uploading documents first
                    <br><br>
                    - Remove document requirement from frontend chat interface<br>
                    - Update placeholder text to be more general and welcoming<br>
                    - Implement dual-mode backend query system:<br>
                    &nbsp;&nbsp;* RAG mode with document context when documents exist<br>
                    &nbsp;&nbsp;* General legal assistant mode when no documents uploaded<br>
                    - Improve user experience by enabling chat immediately<br>
                    - Backend now provides appropriate prompts for both scenarios
                </div>
                <div class="files">
                    Modified files:<br>
                    ‚Ä¢ frontend/src/app/dashboard/cases/[id]/page.tsx (21 changes)<br>
                    ‚Ä¢ src/routes/query.ts (14 changes)
                </div>
            </div>

            <h3>Pasos de Deployment:</h3>
            <ol>
                <li>‚úÖ Cambios commiteados en Git</li>
                <li>‚úÖ Push a GitHub ‚Üí Trigger autom√°tico en Render</li>
                <li>‚úÖ Build del frontend (Next.js)</li>
                <li>‚úÖ Build del backend (TypeScript)</li>
                <li>‚úÖ Deploy en Render.com (3-5 minutos)</li>
                <li>‚úÖ Verificaci√≥n: Chat funciona sin documentos</li>
            </ol>

            <div class="solution-box">
                <strong>üéâ Deployment Exitoso</strong><br>
                Los cambios est√°n en producci√≥n y disponibles para todos los usuarios.
                El sistema ahora permite usar el chat inmediatamente al entrar a un caso.
            </div>
        </section>

        <section id="future" class="section">
            <h2>üîÆ Mejoras Futuras Potenciales</h2>

            <h3>Modo H√≠brido:</h3>
            <div class="info-box">
                Combinar b√∫squeda en documentos del caso + b√∫squeda en biblioteca legal global para respuestas m√°s completas.
            </div>

            <div class="code-block">
<span class="comment">// Concepto: Modo H√≠brido</span>
<span class="keyword">if</span> (hasDocuments) {
  <span class="comment">// Buscar en documentos del caso</span>
  <span class="keyword">const</span> caseChunks = <span class="function">searchCaseDocuments</span>(query);

  <span class="comment">// TAMBI√âN buscar en documentos legales globales</span>
  <span class="keyword">const</span> legalChunks = <span class="function">searchLegalLibrary</span>(query);

  <span class="comment">// Combinar ambos contextos</span>
  <span class="keyword">const</span> hybridContext = <span class="function">mergeContexts</span>(caseChunks, legalChunks);

  <span class="comment">// GPT-4 recibe contexto completo</span>
  <span class="keyword">return</span> <span class="function">generateAnswer</span>(hybridContext, query);
}
            </div>

            <h3>Otras Mejoras:</h3>
            <ul>
                <li>üîç <strong>B√∫squeda en Biblioteca Legal Global:</strong> Siempre buscar en constituciones, leyes, c√≥digos</li>
                <li>üí¨ <strong>Conversaci√≥n Contextual:</strong> Mantener historial de conversaci√≥n para follow-ups</li>
                <li>üìä <strong>Analytics:</strong> Tracking de queries sin documentos vs con documentos</li>
                <li>üéØ <strong>Sugerencias Inteligentes:</strong> Sugerir documentos relevantes seg√∫n la pregunta</li>
                <li>‚öôÔ∏è <strong>Configuraci√≥n de Modo:</strong> Permitir al usuario elegir modo manual</li>
            </ul>
        </section>

        <div class="info-box" style="margin-top: 40px;">
            <strong>üìù Documento Generado:</strong> 2025-01-15<br>
            <strong>üìç Feature:</strong> Chat Sin Documentos<br>
            <strong>üîß Versi√≥n:</strong> 1.1.0<br>
            <strong>üë®‚Äçüíª Commits:</strong> 2f7e692, 856a593
        </div>
    </div>
</body>
</html>